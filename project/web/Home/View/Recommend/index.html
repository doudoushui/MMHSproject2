<extend name="Public/index"/>
<block name="content">
	<style>
	#ul > ul{
		width: 33%;
		float: left;
		padding: 10px;
	}
	#item{
		border:1px solid #acf;
		border-radius: 10px;
		margin-top: 50px;
	}
	</style>
  <!-- <h1>招聘信息公布平台</h1> -->
  <div class="container" style="margin-top:10px;">
    <!--轮播-->
    <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
        <!-- Indicators -->
        <ol class="carousel-indicators">
          <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
          <li data-target="#carousel-example-generic" data-slide-to="1"></li>
          <li data-target="#carousel-example-generic" data-slide-to="2"></li>
        </ol>

        <!--Wrapper for slides -->
        <div class="carousel-inner" role="listbox">
          <div class="item active">
            <img src="__PUBLIC__/Uploads/Recommend/1.jpg" height="200px;">
          </div>
          <div class="item">
            <img src="__PUBLIC__/Uploads/Recommend/2.jpg" height="200px;">
          </div>
          <div class="item">
            <img src="__PUBLIC__/Uploads/Recommend/3.jpg" height="200px;">
          </div>
        </div>
        <!-- Controls -->
        <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
          <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
          <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
      <!--End 轮播-->
		
	  <!--js特效轮播-->
      <!-- <div id="slider-container">
		<div class="box_skitter box_skitter_large">
		<ul>
			<li>
				<a href="{:U('Home/Recommend/index')}"><img src="__PUBLIC__/Home/Jlb/images/index1.jpg" alt="" /></a>
				<div class="label_text">
					<h3 class="colortext uppercase"> 帮你展现更美的自已
					</h3>
					<span>彩妆刷系列轻易打造你的个性妆容！夏末天气也越来越舒爽的，</span>
				</div>
			</li>
			<li>
				<a href="{:U('Home/Recommend/index')}"><img src="__PUBLIC__/Home/Jlb/images/index2.jpg"alt="" /></a>
				<div class="label_text">
					<h3 class="colortext uppercase">帮你展现更美的自已
					</h3>
					<span>专业的刷具能帮你轻松打造自然妆容，你会发现用了专业刷具，
					</span>
				</div>
			</li>
			<li>
				<a href="{:U('Home/Recommend/index')}"><img src="__PUBLIC__/Home/Jlb/images/index3.jpg" alt="" /></a>
				<div class="label_text">
					<h3 class="colortext uppercase">帮你展现更美的自已
					</h3>
					<span>彩妆刷让你打造美丽妆容更加得心应手。彩妆刷已从专业造型师手中，
					</span>
				</div>
			</li>
		</ul>
		</div>
		<div id="shadow-img-slider"></div>
	  </div><!-- end #slider-container -->
 
        <!-- <div class="row" style="margin-top:10px;">
          <foreach name="Recommends" item="vo" key="k" >                           
            <div class="col-sm-6 col-md-3">
              <div class="thumbnail">
                <!-- <img src="holder.js/242x200" alt="..."> 
                <div class="caption">
                  <h3 style="line-height:35px">{$vo.work}</h3>
                  <p>{$vo.Recommend_intro}</p>
                  <p>
                    <a href="{:U('Home/Recommend/intro')}" class="btn btn-primary" role="button">岗位详情</a><br><br>
                    <a href="{:U('Home/Recommend/sent')}" class="btn btn-default" role="button">填写简历</a>
                  </p>
                </div>
              </div>
            </div>
          </foreach>
        </div> -->
  </div>

	<div style="width: 1080px;height:auto;margin: 0 auto;">
		<li id="item" style="display:none; margin-top:10px; margin-left:130px; width: 200px;height: 320px;border:solid 1px #ccc;padding: 10px;text-align:center;">
		  <h3>优秀婚庆公司</h3>
		  <p>公司简介: <span>公司介绍</span></p>
		  <p>&nbsp;&nbsp;
	       <a href="{:U('Home/Recommend/r_msg')}" class="btn btn-primary" role="button" >公司详情</a><br><br>
	       <!-- <a href="{:U('Home/Recommend/sent')}" class="btn btn-default" role="button">填写简历</a> -->
	      </p>
		</li>
		<div id="ul">
		<ul></ul>
		<ul></ul>
		<ul></ul>
		<!-- <ul></ul> -->
		</div>
		<div style="clear:both"></div>
	</div>
  <script type="text/javascript" src="__PUBLIC__/Home/Scripts/jquery-1.8.3.min.js"></script>
  <script type="text/javascript">
	//全局配置
	var p = 1;//页码信息
	var isLoading = false;
	var url = "{:U('Home/Recommend/ajax')}";

	p = requestRecommends();
	// console.log(p);
		//封装函数发起请求
		function requestRecommends(){
			//加载请求时关门
			isLoading = true;
			//发起请求
			$.post(url,{p:p},function(data){
				// console.log(data);
				//循环遍历创建元素
				for (var i = 0; i < data.length; i++) {
					//创建元素
					// var newLi = $('#item').clone();
					// var id = data[i]['id'];
					var str = data[i]['id'];
					// alert(str)
					var newLi = $('<li id="item" style="display:none">\n\
						<h3 style="line-height:35px">优秀婚庆公司</h3>\n\
                  			<p>&nbsp;&nbsp;&nbsp;公司简介: <br><span>公司介绍</span></p>\n\
                 			<p>\n\
                    		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="intro/id/'+str+'" class="btn btn-primary" type="button">公司详情</a><br>\n\
                  			</p>\n\
						</li>');
					//显示
					newLi.show();
					//修改标题和介绍
					newLi.find('h3').html('婚庆公司: '+data[i]['r_title']);
					newLi.find('span').html('&nbsp;&nbsp;&nbsp;'+data[i]['rintro']);
					//取余插入  一行3条
					var index = i%3;
					//插入到ul中
					$('#ul >ul:eq('+index+')').append(newLi);
				};
				//让页码自增
				// p++;
				//打开
				isLoading = false;
			},'json')
			return ++p;
		}

	//绑定滚动事件
	$(window).scroll(function(){
		//检测当前是否正在发起请求
		if(isLoading){return;}
		//获取整个文档的高度
		var sH = $(document).height();
		console.log(sH);
		//获取页面滚动高度
		var sT = $(window).scrollTop();
		// console.log(sT);
		//可视区域的高度
		var  cH = $(window).height();
		// console.log(cH);
		if(sH <= sT+cH+300){
			requestRecommends();
		}
	})
	</script>

</block>

